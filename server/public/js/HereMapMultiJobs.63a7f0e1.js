(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["HereMapMultiJobs"],{"7fe0":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"map"},[a("div",{ref:"hereMap",staticClass:"map-container multi"})])},n=[],o=(a("99af"),a("4160"),a("d81d"),a("b0c0"),a("d3b7"),a("3ca3"),a("159b"),a("ddb0"),a("96cf"),a("c964")),s=a("1ba6"),i={name:"HereMapMultiJobs",props:{jobs:{type:Array,default:function(){return[]}}},data:function(){return{platform:null,map:null,ui:null,apikey:"n3GOlcV0Z6utqCKpJlDWH6lWYtJdvR0QomMzYs_EreM",companyCountryOptions:s["a"]}},watch:{jobs:function(){this.map&&(this.deleteMarkers(),this.addMarkers())}},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$loadScript("https://js.api.here.com/v3/3.1/mapsjs-core.js");case 3:return t.next=5,Promise.all([e.$loadScript("https://js.api.here.com/v3/3.1/mapsjs-service.js"),e.$loadScript("https://js.api.here.com/v3/3.1/mapsjs-mapevents.js"),e.$loadScript("https://js.api.here.com/v3/3.1/mapsjs-ui.js")]);case 5:a=new window.H.service.Platform({apikey:e.apikey}),e.platform=a,e.initializeHereMap(),t.next=12;break;case 10:t.prev=10,t.t0=t["catch"](0);case 12:case"end":return t.stop()}}),t,null,[[0,10]])})))()},methods:{forward:function(e){this.$router.push("/stellenangebote/job/".concat(e))},initializeHereMap:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r,n,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a=6.3,t.prev=2,t.next=5,new Promise((function(t,r){window.navigator.geolocation.getCurrentPosition((function(e){e.coords?(a=8,t({lat:e.coords.latitude,lng:e.coords.longitude})):r("")}),(function(){return t(e.$config.maps.defaultCenter)}))}));case 5:r=t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](2),r=e.$config.maps.defaultCenter;case 11:r||(r=e.$config.maps.defaultCenter),n=e.$refs.hereMap,o=window.H,s=e.platform.createDefaultLayers({lg:e.$config.maps.lang}),e.map=new o.Map(n,s.vector.normal.map,{zoom:a,center:r}),addEventListener("resize",(function(){return e.map.getViewPort().resize()})),new o.mapevents.Behavior(new o.mapevents.MapEvents(e.map)),e.ui=o.ui.UI.createDefault(e.map,s),e.addMarkers(),t.next=25;break;case 22:t.prev=22,t.t1=t["catch"](0),e.$root.$bvToast.toast("Die Karte konnten nicht geladen werden.",{title:"Fehler beim Laden",variant:"danger",toaster:"b-toaster-bottom-right",solid:!0,noAutoHide:!1});case 25:case"end":return t.stop()}}),t,null,[[0,22],[2,8]])})))()},addMarkers:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.map&&e.jobs.length>0&&(a=window.H,r=new a.map.Group,n=e.createMarkersInput(e.jobs),o=e.createMarkers(a,r,n),e.map.addObject(o));case 1:case"end":return t.stop()}}),t)})))()},createMarkersInput:function(e){var t=this;return e.map((function(e){return{geocode:{lat:t.spreadMarker(e.company.geoCodeLat),lng:t.spreadMarker(e.company.geoCodeLng)},companyName:e.company.name,logoUrl:e.company.logoUrl,jobs:[{jobTitle:e.title,jobId:e._id}]}}))},createMarkers:function(e,t,a){var r=this;return a.forEach(function(){var a=Object(o["a"])(regeneratorRuntime.mark((function a(n){var o,s,i,c,u,p;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:o=n.geocode,s=document.createElement("div"),s.classList.add("icon-outer"),i=document.createElement("img"),i.classList.add("icon-inner"),i.src=n.logoUrl||"/img/favicon.ico",s.appendChild(i),c=new e.map.DomIcon(s),u=new window.H.map.DomMarker(o,{icon:c}),p='<div class="map-bubble mb-2"><strong>'.concat(n.companyName,'</strong></div><hr class="my-1" />'),n.jobs.forEach((function(e){p+='<p class="my-0"><a href="/stellenangebote/job/'.concat(e.jobId,'" target="_blank">').concat(e.jobTitle,'</a></p><hr class="my-1" />')})),u.setData(p),u.addEventListener("tap",(function(t){var a=new e.ui.InfoBubble(t.target.getGeometry(),{content:t.target.getData()});r.ui.addBubble(a)})),t.addObject(u);case 14:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()),t},deleteMarkers:function(){this.map&&this.map.removeObjects(this.map.getObjects())},spreadMarker:function(e){var t=5e-4;return e+Math.random()*t-Math.random()*t}}},c=i,u=a("2877"),p=Object(u["a"])(c,r,n,!1,null,null,null);t["default"]=p.exports}}]);
//# sourceMappingURL=HereMapMultiJobs.63a7f0e1.js.map